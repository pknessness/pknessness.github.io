<!DOCTYPE html>
<html>
<head>
    <title>PID control simulator</title>
    <meta charset="utf-8">
    
    <link rel="stylesheet" href="jquery-ui.css">
    <link rel="stylesheet" href="stylesheet.css">
    <link rel="stylesheet" href="../stylesheet.css">
    <style>
    </style>
    
    <script src="jquery.min.js"></script>
    <script src="jquery-ui.min.js"></script>
    <script src="plot.js"></script>
    <script src="pid.js"></script>
    <script src="pid-autotune.js"></script>
    <script src="main.js"></script>
</head>
<body>
    <div style="font-size:15px;padding:10px;" class="window">
        This PID control simulator allows you to try out a PID controller interactively by adjusting the tuning parameters in realtime.
        
        On the right you can see a list, that will record and list the maximum overshoot for any given set of PID values that you've tested, so you can track your progress. It is a tad buggy if you move the setpoint around a lot, so keep that in mind. To test a PID, move the setpoint, wait for it to stabilize, and then do so a few more times. This will give you a general sense of the overshoot of a set of PID tunings.
    </div>
    <br>
    <div id="plots" style="display: flex">
        <div class="sunken-panel">
            <canvas id="plot1" width="700" height="400"></canvas>   
        </div>
        <div id="overshot" style="width:200px;">
            <div id="overshot1">1</div> <br>
            <div id="overshot2">2</div> <br>
            <div id="overshot3">3</div> <br>
            <div id="overshot4">4</div> <br>
            <div id="overshot5">5</div> <br>
            <div id="overshot6">6</div> <br>
            <div id="overshot7">7</div> <br>
            <div id="overshot8">8</div> <br>
            <div id="overshot9">9</div> 
        </div> 
        <canvas id="whee" width="350" height="350"></canvas>  
    </div>  
    <br>
    <!-- time:<span id="time"></span> -->
    
    <!-- <button id="autotune">Auto tune</button>
    tune step <input id="tunestep" type="textbox" size="4" value="50"></input>
    tune noise <input id="tunenoise" type="textbox" size="4" value="1"></input>
    tune start <input id="tunestart" type="textbox" size="4" value="100"></input>
    tune loopback (sec) <input id="tuneloopback" type="textbox" size="4" value="20"></input>
    
    <p> -->
        
        <span class="field-row" style="width:100%">
            <label style="white-space: nowrap;"><b>Example Presets:</b></label>
            <label id="process">?</label>
            <!-- <div style="width:95%" id="sliderSetpoint"></div> -->
            <input id="sliderProcess" style="width:15%" type="range" min="0" max="1" value="0" onchange="processChanged();"/>
        
            <button id="start">Start</button>
            <button id="stop">Stop</button>
            <button id="toggle">PID is ON</button>

            <label><b>Desired:</b></label><label id="desired" style="color: #00008F;"></label>
            <label><b>Actual:</b></label><label id="actual" style="color: #8F0000;"></label>
            <label><b>Output:</b></label><label id="output" style="color: #008F00;"></label>
            <button id="testSequenceButton" onclick="testSequence(); " style="white-space: nowrap; width: fit-content;">Test Sequence</button>
        </span>
        <!-- <span style="float:left;margin-right:10px">
            <label >Process example:</label>
            <div style="display:inline-block;width:100px;margin-right:10px;margin-left:10px" id="sliderProcess"></div>
            <label style="display:inline-block;width:250px" id="process"></label>
            
        </span>   -->
        
        <span hidden>  
            Sample time (ms):
            <span style="display:inline-block;width:40px" id="sampletime"></span>
            <div style="display:inline-block;width:100px;margin-left:10px" id="sliderSampletime" ></div>
        </span>
        
        <div class="row">
            <fieldset class="column">
                <div class="field-row">
                    <label style="font-size:15px;">Setpoint:</label>
                    <label id="setpoint" style="font-size:15px;">?</label>
                    <!-- <div style="width:95%" id="sliderSetpoint"></div> -->
                    <input id="sliderSetpoint" type="range" min="1" max="11" value="5" onchange="setpointChanged();"/>
                </div>
                
                <div hidden>
                    Noise:
                    <span id="noise"></span>
                    <div style="width:95%" id="sliderNoise"></div>
                </div>
                
                <div>
                    Kp (proportional gain):
                    <span id="kp"></span>
                    <div style="width:95%" id="sliderKp"></div>
                </div>
                
                <div>
                    Ki (integral gain):
                    <span id="ki"></span>
                    <div style="width:95%" id="sliderKi"></div>
                </div>
                
                <div>
                    Kd (derivative gain):
                    <span id="kd"></span>
                    <div style="width:95%" id="sliderKd"></div>
                </div>

                <div>
                    I cap (Maximum of the I component):
                    <span id="icap"></span>
                    <div style="width:95%" id="sliderIcap"></div>
                </div>
                <br>
                Feed Forward (model): control input = function(input, setpoint, user): <br>
                <textarea id="ffFunc" rows="3" style="width:95%"></textarea> <br>
                <button id="applyFF">Apply</button>
            </fieldset>
            <div class="column">
                DIV
            </div>
        </div>
        <br>
        
        
        <p>
            <b>Manual tuning hints</b>
            <ul>
                <li>If it overshoots a lot and oscillates, either the integral gain (I) needs to be increased or all gains (P,I,D) should be reduced</li>
                <li>Too much overshoot? Increase D, decrease P.</li>
                <li>Response too damped? Increase P.</li>
                <li>Ramps up quickly to a value below target value and then slows down as it approaches target value? Try increasing the I constant.</li>
            </ul>
        </p>
        
        Also, you can adjust the process model by Javascript code below. This simulator was developed by porting the 
        <a href="https://github.com/br3ttb/Arduino-PID-Library">Arduino PID library</a> and the  
        <a href="https://github.com/br3ttb/Arduino-PID-AutoTune-Library">Arduino-PID-AutoTune-Library</a></li> to Javascript.     
    
        <br><br>

        <div>  
            Process function (model): control input = function(time, input, output, user):<br>  
            <textarea id="processFunc" rows="10" cols="100"></textarea>
            <button id="apply">Apply</button>
            <br>  
            <b>Process function parameters:<br></b>  
            output: control output (PID OUTPUT)<br>
            function return value: control input<br>
            input: last control input (optional)<br>  
            user: custom variable to store long-term data (optional)<br>
            time: current time (ms) (optional)<br>      
        </div>
        <br>
        <div>  
            Test Sequence Parameters:<br>  
            <textarea id="testSequence" rows="10" cols="100">
0MS,-5;
4000MS,100;
8000MS,-150;
12000MS,-180;
14000MS,50;
18000MS,0;
            </textarea>
            <br>  
            <b>Test Sequence parameters:<br></b>  
            [TIME]MS, [POS];<br>      
        </div>
        
        
        <b>Further links</b>
        <ul>
            <li><a href="https://github.com/br3ttb/Arduino-PID-Library">Arduino-PID-Library</a></li>
            <li><a href="https://github.com/br3ttb/Arduino-PID-AutoTune-Library">Arduino-PID-AutoTune-Library</a></li>
        </ul>  
        This is NOT OF MY CREATION, this is a modification of an amazing program, and you can find that at <a href="https://www.grauonline.de/alexwww/ardumower/pid/pid.html">https://www.grauonline.de/alexwww/ardumower/pid/pid.html</a>. It has been modified by Anshal Jain (pknessness). Credit goes to the original creators, I'm just modifing it to better fit my needs and add features that I think are useful.
        <br>
        <br>
        <br> 
        
    </body>
    </html>
    
    
    